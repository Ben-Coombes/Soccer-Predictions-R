{
    "collab_server" : "",
    "contents" : "library(XML)\nlibrary(dplyr)\nlibrary(tibble)\nlibrary(tidyr)\ntrim <- function (x)\n  gsub(\"^\\\\s+|\\\\s+$\", \"\", x)\nPL_picks <-\n  data.frame(\n    Game = character(),\n    Market = character(),\n    Odds = numeric(),\n    stringsAsFactors = FALSE\n  )\ncounter <- 0\nfor (p in 1:10) {\n  ahurl <- \"http://www.soccerstats.com/homeaway.asp?league=england\"\n  H_A <- readHTMLTable(ahurl, which = 7)\n  \n  H <- H_A[-c(22:88, 1),]\n  \n  H$V1 <- NULL\n  H$V4 <- NULL\n  H$V5 <- NULL\n  H$V6 <- NULL\n  H$V9 <- NULL\n  H$V10 <- NULL\n  \n  colnames(H)[1] <- \"Team\"\n  colnames(H)[2] <- \"GP\"\n  colnames(H)[3] <- \"GF\"\n  colnames(H)[4] <- \"GA\"\n  \n  H$GP <- as.numeric(levels(H$GP))[H$GP]\n  H$GF <- as.numeric(levels(H$GF))[H$GF]\n  H$GA <- as.numeric(levels(H$GA))[H$GA]\n  \n  H$AGF <- round(H$GF / H$GP, 2)\n  H$AGA <- round(H$GA / H$GP, 2)\n  \n  H_meanGF <- round(mean(H$AGF), 2)\n  H_meanGA <- round(mean(H$AGA), 2)\n  \n  H$atkstr <- round(H$AGF / H_meanGF, 2)\n  H$defstr <- round(H$AGA / H_meanGA, 2)\n  \n  A <- H_A[-c(1:22, 43:88),]\n  A$V1 <- NULL\n  A$V4 <- NULL\n  A$V5 <- NULL\n  A$V6 <- NULL\n  A$V9 <- NULL\n  A$V10 <- NULL\n  \n  colnames(A)[1] <- \"Team\"\n  colnames(A)[2] <- \"GP\"\n  colnames(A)[3] <- \"GF\"\n  colnames(A)[4] <- \"GA\"\n  \n  A$GP <- as.numeric(levels(A$GP))[A$GP]\n  A$GF <- as.numeric(levels(A$GF))[A$GF]\n  A$GA <- as.numeric(levels(A$GA))[A$GA]\n  \n  A$AGF <- round(A$GF / A$GP, 2)\n  A$AGA <- round(A$GA / A$GP, 2)\n  \n  A_meanGF <- round(mean(A$AGF), 2)\n  A_meanGA <- round(mean(A$AGA), 2)\n  \n  A$atkstr <- round(A$AGF / A_meanGF, 2)\n  A$defstr <- round(A$AGA / A_meanGA, 2)\n  \n  matchesurl <-\n    \"http://www.soccerstats.com/latest.asp?league=england#\"\n  matches <- readHTMLTable(matchesurl, which = 9)\n  matches$V1 <- NULL\n  matches$V3 <- NULL\n  matches$V4 <- NULL\n  matches <- na.omit(matches)\n  matches <-\n    separate(\n      data = matches,\n      col = V2,\n      into = c(\"Home\", \"Away\"),\n      sep = \"\\\\-\"\n    )\n  matches$Home <- trim(matches$Home)\n  matches$Away <- trim(matches$Away)\n  \n  hometeam <- matches$Home[p]\n  awayteam <- matches$Away[p]\n  hleague <- H$Team\n  aleague <- A$Team\n  \n  hattackstrength <- subset(H, grepl(hometeam, hleague))\n  hdefensivestrength <- subset(H, grepl(hometeam, hleague))\n  aattackstrength <- subset(A, grepl(awayteam, aleague))\n  adefensivestrength <- subset(A, grepl(awayteam, aleague))\n  \n  counter <- counter + 1\n  \n  hGE <-\n    as.numeric(hattackstrength[7] * adefensivestrength[8] * H_meanGF)\n  aGE <-\n    as.numeric(aattackstrength[7] * hdefensivestrength[8] * A_meanGF)\n  \n  \n  for (i in 0:9) {\n    nam <- paste(\"p0_\", i, sep = \"\")\n    assign(nam, (dpois(0, hGE)) * (dpois (i, aGE)) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p1_\", i, sep = \"\")\n    assign(nam, dpois(1, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p2_\", i, sep = \"\")\n    assign(nam, dpois(2, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p3_\", i, sep = \"\")\n    assign(nam, dpois(3, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p4_\", i, sep = \"\")\n    assign(nam, dpois(4, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p5_\", i, sep = \"\")\n    assign(nam, dpois(5, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p6_\", i, sep = \"\")\n    assign(nam, dpois(6, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p7_\", i, sep = \"\")\n    assign(nam, dpois(7, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p8_\", i, sep = \"\")\n    assign(nam, dpois(8, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  for (i in 0:9) {\n    nam <- paste(\"p9_\", i, sep = \"\")\n    assign(nam, dpois(9, hGE) * dpois (i, aGE) * 100)\n    \n  }\n  \n  h0 <- c(p0_0, p0_1, p0_2, p0_3, p0_4, p0_5, p0_6, p0_7, p0_8, p0_9)\n  h1 <- c(p1_0, p1_1, p1_2, p1_3, p1_4, p1_5, p1_6, p1_7, p1_8, p1_9)\n  h2 <- c(p2_0, p2_1, p2_2, p2_3, p2_4, p2_5, p2_6, p2_7, p2_8, p2_9)\n  h3 <- c(p3_0, p3_1, p3_2, p3_3, p3_4, p3_5, p3_6, p3_7, p3_8, p3_9)\n  h4 <- c(p4_0, p4_1, p4_2, p4_3, p4_4, p4_5, p4_6, p4_7, p4_8, p4_9)\n  h5 <- c(p5_0, p5_1, p5_2, p5_3, p5_4, p5_5, p5_6, p5_7, p5_8, p5_9)\n  h6 <- c(p6_0, p6_1, p6_2, p6_3, p6_4, p6_5, p6_6, p6_7, p6_8, p6_9)\n  h7 <- c(p7_0, p7_1, p7_2, p7_3, p7_4, p7_5, p7_6, p7_7, p7_8, p7_9)\n  h8 <- c(p8_0, p8_1, p8_2, p8_3, p8_4, p8_5, p8_6, p8_7, p8_8, p8_9)\n  h9 <- c(p9_0, p9_1, p9_2, p9_3, p9_4, p9_5, p9_6, p9_7, p9_8, p9_9)\n  \n  pg <- data.frame(h0, h1, h2, h3, h4, h5, h6, h7, h8, h9)\n  pg <- t(pg)\n  pg <- round(pg, 3)\n  pg <- data.frame(pg)\n  \n  colnames(pg)[1] <- \"a0\"\n  colnames(pg)[2] <- \"a1\"\n  colnames(pg)[3] <- \"a2\"\n  colnames(pg)[4] <- \"a3\"\n  colnames(pg)[5] <- \"a4\"\n  colnames(pg)[6] <- \"a5\"\n  colnames(pg)[7] <- \"a6\"\n  colnames(pg)[8] <- \"a7\"\n  colnames(pg)[9] <- \"a8\"\n  colnames(pg)[10] <- \"a9\"\n  \n  hWin <-\n    sum(pg$a0[2:10],\n        pg$a1[3:10],\n        pg$a2[4:10],\n        pg$a3[5:10],\n        pg$a4[6:10],\n        pg$a5[7:10],\n        pg$a6[8:10],\n        pg$a7[9:10],\n        pg$a8[10])\n  draw <-\n    sum(pg$a0[1],\n        pg$a1[2],\n        pg$a2[3],\n        pg$a3[4],\n        pg$a4[5],\n        pg$a5[6],\n        pg$a6[7],\n        pg$a7[8],\n        pg$a8[9],\n        pg$a9[10])\n  aWin <-\n    sum(pg$a1[1],\n        pg$a2[1:2],\n        pg$a3[1:3],\n        pg$a4[1:4],\n        pg$a5[1:5],\n        pg$a6[1:6],\n        pg$a7[1:7],\n        pg$a8[1:8],\n        pg$a9[1:9])\n  o1.5 <-\n    sum(pg$a0[3:10],\n        pg$a1[2:10],\n        pg$a2[1:10],\n        pg$a3[1:10],\n        pg$a4[1:10],\n        pg$a5[1:10],\n        pg$a6[1:10],\n        pg$a7[1:10],\n        pg$a8[1:10],\n        pg$a9[1:10])\n  u1.5 <- sum(pg$a0[1:2], pg$a1[1])\n  o2.5 <-\n    sum(pg$a0[4:10],\n        pg$a1[3:10],\n        pg$a2[2:10],\n        pg$a3[1:10],\n        pg$a4[1:10],\n        pg$a5[1:10],\n        pg$a6[1:10],\n        pg$a7[1:10],\n        pg$a8[1:10],\n        pg$a9[1:10])\n  u2.5 <- sum(pg$a0[1:3], pg$a1[1:2], pg$a2[1])\n  o3.5 <-\n    sum(pg$a0[5:10],\n        pg$a1[4:10],\n        pg$a2[3:10],\n        pg$a3[2:10],\n        pg$a4[1:10],\n        pg$a5[1:10],\n        pg$a6[1:10],\n        pg$a7[1:10],\n        pg$a8[1:10],\n        pg$a9[1:10])\n  u3.5 <- sum(pg$a0[1:4], pg$a1[1:3], pg$a2[1:2], pg$a3[1])\n  o4.5 <-\n    sum(pg$a0[6:10],\n        pg$a1[5:10],\n        pg$a2[4:10],\n        pg$a3[3:10],\n        pg$a4[2:10],\n        pg$a5[1:10],\n        pg$a6[1:10],\n        pg$a7[1:10],\n        pg$a8[1:10],\n        pg$a9[1:10])\n  u4.5 <- sum(pg$a0[1:5], pg$a1[1:4], pg$a2[1:3], pg$a3[1:2], pg$a4[1])\n  BTTS_Y <-\n    sum(pg$a1[2:10],\n        pg$a2[2:10],\n        pg$a3[2:10],\n        pg$a4[2:10],\n        pg$a5[2:10],\n        pg$a6[2:10],\n        pg$a7[2:10],\n        pg$a8[2:10],\n        pg$a9[2:10])\n  BTTS_N <-\n    sum(pg$a0[1:10],\n        pg$a1[1],\n        pg$a2[1],\n        pg$a3[1],\n        pg$a4[1],\n        pg$a5[1],\n        pg$a6[1],\n        pg$a7[1],\n        pg$a8[1],\n        pg$a9[1])\n  \n  \n  prediction <-\n    t(data.frame(\n      hWin,\n      draw,\n      aWin,\n      o1.5,\n      u1.5,\n      o2.5,\n      u2.5,\n      o3.5,\n      u3.5,\n      o4.5,\n      u4.5,\n      BTTS_Y,\n      BTTS_N\n    ))\n  prediction <- data.frame(prediction)\n  prediction <- rownames_to_column(prediction, \"Market\")\n  prediction[\"Game\"] <- paste(hometeam, awayteam, sep = \" v. \")\n  prediction <- prediction[, c(3, 1, 2)]\n  colnames(prediction)[3] <- \"Odds\"\n  \n  assign(paste(\"PROB\", p, sep = \"\"),\n         subset(prediction, prediction$Odds >= 0))\n  \n}\nPL_picks <-\n  mget(paste('PROB', 1:counter, sep = \"\"), envir = parent.frame())\nPL_picks <- do.call('rbind', PL_picks)\nrownames(PL_picks) <- NULL\nPL_picks[\"Decimal\"] <- round(100 / PL_picks$Odds, 2)\n",
    "created" : 1502448305319.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "163717473",
    "id" : "20E7C2E2",
    "lastKnownWriteTime" : 1514261077,
    "last_content_update" : 1514261077303,
    "path" : "C:/Users/Ben/Desktop/Items/Soccer Stats/Premier League.R",
    "project_path" : "Premier League.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}